<!DOCTYPE html>
<html>
  <head>
    <title>Rally PeruMoney üöÄüèÅ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      body {
        margin: 0;
        padding: 20px;
        font-family: Arial, sans-serif;
        background: #f5f5f5;
      }
      .chart-container {
        background: white;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        width: 95%;
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        box-sizing: border-box;
      }
      h2 {
        text-align: center;
        color: #333;
        font-size: 24px;
        margin: 0 0 10px 0;
      }
      .total-registros {
        text-align: center;
        color: #666;
        font-size: 16px;
        margin: 0 0 20px 0;
      }
      .chart-wrapper {
        position: relative;
        width: 100%;
      }
      @media (max-width: 768px) {
        body {
          padding: 10px;
        }
        .chart-container {
          padding: 15px;
          width: 98%;
        }
        h2 {
          font-size: 20px;
        }
        .total-registros {
          font-size: 14px;
          margin-bottom: 15px;
        }
      }
    </style>
  </head>
  <body>
    <div class="chart-container">
      <h2>Rally PeruMoney üöÄüèÅ</h2>
      <div id="total-registros-display" class="total-registros"></div>
      <h6>update 23/06/2025 00:00</h6>
      <div class="chart-wrapper">
        <canvas id="userChart"></canvas>
      </div>
    </div>

    <script>
      // ===================================================================================
      // ‚ú® DATOS ACTUALIZADOS SEG√öN LA √öLTIMA IMAGEN ‚ú®
      // ===================================================================================
      const userData = [
        { nombre: "EHENCKELL", registros: 129 },
        { nombre: "MBRENA", registros: 121 },
        { nombre: "AALEGRE", registros: 65 },
        { nombre: "ZELIAS", registros: 61 },
        { nombre: "CRAVELLO", registros: 58 },
        { nombre: "SHANCO", registros: 38 },
        { nombre: "RMEZA", registros: 27 },
        { nombre: "PROSILLO", registros: 22 },
        { nombre: "YHUERE", registros: 20 },
        { nombre: "AMAU", registros: 19 },
        { nombre: "MESPINOZA", registros: 18 },
        { nombre: "DCUTIMBO", registros: 16 },
        { nombre: "JRIVERA", registros: 16 },
        { nombre: "SDURAND", registros: 14 },
        { nombre: "DPEDREROS", registros: 10 },
        { nombre: "AESPINOZA", registros: 9 },
        { nombre: "OTORRES", registros: 9 },
        { nombre: "YARPE", registros: 8 },
        { nombre: "BCABANA", registros: 8 },
        { nombre: "MVASQUEZ", registros: 7 },
        { nombre: "ERONDOY", registros: 7 },
        { nombre: "NHUAMANCA", registros: 7 },
        { nombre: "MGALVEZ", registros: 6 },
        { nombre: "LHUARI", registros: 5 },
        { nombre: "LCALDERON", registros: 5 },
        { nombre: "YRUYZ", registros: 5 },
        { nombre: "IBOCANEGRA", registros: 4 },
        { nombre: "JUCANAN", registros: 4 },
        { nombre: "KOJEDA", registros: 4 },
        { nombre: "JMARCHAN", registros: 3 },
        { nombre: "LCANCHARI", registros: 3 },
        { nombre: "KANGELES", registros: 3 },
        { nombre: "NGUERRA", registros: 3 },
        { nombre: "LNAVARRO", registros: 3 },
        { nombre: "BJAIMES", registros: 3 },
        { nombre: "JHERENCIA", registros: 3 },
        { nombre: "LSOTO", registros: 2 },
        { nombre: "GGARCIA", registros: 2 },
        { nombre: "KSILVA", registros: 2 },
        { nombre: "DMARCELO", registros: 2 },
        { nombre: "SROMERO", registros: 2 },
        { nombre: "SCONDOR", registros: 1 },
        { nombre: "MNAJARRO", registros: 1 },
        { nombre: "MMENDOZA", registros: 1 },
        { nombre: "CHUAMAN", registros: 1 },
        { nombre: "ASEGURA", registros: 1 },
        { nombre: "KPALOMINO", registros: 1 },
        { nombre: "JVILELA", registros: 1 },
        { nombre: "AZARZOZA", registros: 1 },
        { nombre: "YCHAVEZ", registros: 1 },
        { nombre: "ACRUZ", registros: 1 },
        { nombre: "FGUILLEN", registros: 1 },
        { nombre: "TEGUSQUIZA", registros: 1 },
        { nombre: "DSEIRE", registros: 1 },
        { nombre: "SQUIROZ", registros: 1 },
      ];

      // 1. Ordenar los datos de mayor a menor
      userData.sort((a, b) => b.registros - a.registros);

      // 2. Preparar los datos para Chart.js
      const labels = userData.map((user) => user.nombre);
      const dataPoints = userData.map((user) => user.registros);

      // 3. Calcular y mostrar el total de registros
      const totalRegistros = dataPoints.reduce(
        (sum, current) => sum + current,
        0
      );
      document.getElementById(
        "total-registros-display"
      ).innerText = `Total de registros: ${totalRegistros}`;

      // 4. Funci√≥n para generar colores
      function generateColors(num) {
        const colors = [
          "#FF6384",
          "#36A2EB",
          "#FFCE56",
          "#4BC0C0",
          "#9966FF",
          "#FF9F40",
        ];
        while (colors.length < num) {
          colors.push(
            "#" +
              Math.floor(Math.random() * 16777215)
                .toString(16)
                .padStart(6, "0")
          );
        }
        return colors;
      }

      // 5. Ajustar altura del gr√°fico y renderizarlo
      const ctx = document.getElementById("userChart");
      const barHeight = 25; // Altura en p√≠xeles por cada barra
      const chartHeight = labels.length * barHeight;
      ctx.parentElement.style.height = chartHeight + "px";

      new Chart(ctx, {
        type: "bar",
        data: {
          labels: labels,
          datasets: [
            {
              data: dataPoints,
              backgroundColor: generateColors(userData.length),
              borderWidth: 0,
            },
          ],
        },
        options: {
          indexAxis: "y",
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: { beginAtZero: true, grid: { display: false } },
            y: { grid: { display: false }, ticks: { autoSkip: false } },
          },
          plugins: {
            legend: { display: false },
            tooltip: {
              callbacks: {
                label: (context) => `${context.parsed.x} registros`,
              },
            },
          },
        },
      });
    </script>
  </body>
</html>
